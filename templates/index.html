<!DOCTYPE html>
<html>
<head>
<title>IP Address Information Tool</title>

<link rel="stylesheet"
 href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">

<link rel="stylesheet"
 href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
</head>

<body class="bg-dark text-light">
<div class="container mt-4">

<h3 class="text-center">ğŸŒ IP Address Information Tool</h3>

<form method="POST" class="d-flex gap-2 mt-3">
  <input name="ip_input" class="form-control"
   placeholder="Enter IP address">
  <button class="btn btn-primary">Lookup</button>
</form>

{% if data %}
<div class="card bg-secondary mt-4 p-3">

  <h5>IP: {{ data.ip }}</h5>
  <p>Location: {{ data.city }}, {{ data.country_name }}</p>
  <p>ISP: {{ data.org }}</p>
  <p>Lat: {{ data.latitude }} | Lon: {{ data.longitude }}</p>

  <a class="btn btn-warning mt-2"
     href="/download_pdf/{{ data.ip }}">Download PDF</a>
</div>

<!-- MAP -->
<div id="map" style="height:300px" class="mt-3"></div>

<script>
var map = L.map('map').setView(
  [{{ data.latitude }}, {{ data.longitude }}], 10
);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png')
.addTo(map);
L.marker([{{ data.latitude }}, {{ data.longitude }}]).addTo(map);
</script>
{% endif %}

<!-- HISTORY SECTION -->
<h4 class="mt-4">ğŸ“œ Search History</h4>

{% for h in history[::-1] %}
<div class="card bg-secondary p-2 mt-2">
  <b>{{ h.ip }}</b> â€” {{ h.city }}, {{ h.country }}
</div>
{% endfor %}

</div>
</body>
</html>
